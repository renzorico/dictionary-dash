<!DOCTYPE html>
<html>
<head>
  <title>Dictionary Access Game</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 40px; }
    input, button { padding: 10px; font-size: 1em; margin: 10px; width: 300px; }
    code { background-color: #f2f2f2; padding: 4px; display: block; margin: 20px auto; width: fit-content; }
    #result { font-weight: bold; margin-top: 20px; font-size: 1.2em; }
  </style>
</head>
<body>
  <h1>üîç Access the Value</h1>
  <p>Write the expression that accesses the target value from the dictionary</p>
  <div id="question"></div>
  <input id="input" type="text" placeholder="e.g., dict_['fruit']" />
  <br>
  <button onclick="checkAnswer()">Check Answer</button>
  <div id="result"></div>

  <script>
    function generateRandomDict(depth = 1) {
      const keys = ["fruit", "color", "shape", "animal", "city", "country", "language", "brand", "product", "size"];
      const values = ["apple", "red", "round", "dog", "Paris", "Spain", "French", "Nike", "shoes", 42];
      const dict = {};
      for (let i = 0; i < 3; i++) {
        const key = keys[Math.floor(Math.random() * keys.length)];
        const val = (depth > 1 && Math.random() > 0.5) ? generateRandomDict(depth - 1) : values[Math.floor(Math.random() * values.length)];
        dict[key] = val;
      }
      return dict;
    }

    function findTarget(dict) {
      for (const key in dict) {
        const val = dict[key];
        if (typeof val !== "object") return { key, val };
        const nested = findTarget(val);
        if (nested) return { key: `${key}']['${nested.key}`, val: nested.val };
      }
    }

    let currentDict, expectedCode;

    function newChallenge() {
      currentDict = generateRandomDict(2);
      const { key, val } = findTarget(currentDict);
      expectedCode = `dict_['${key}']`;

      document.getElementById("question").innerHTML =
        `<code>dict_ : ${JSON.stringify(currentDict, null, 2)}</code><br><code>Get to the value '${val}'</code>`;
      document.getElementById("input").value = "";
      document.getElementById("result").textContent = "";
    }

    function checkAnswer() {
      const userCode = document.getElementById("input").value;
      try {
        const dict_ = currentDict;
        const result = eval(userCode);
        const expected = eval(expectedCode);
        if (result === expected) {
          document.getElementById("result").textContent = "‚úÖ Correct!";
        } else {
          document.getElementById("result").textContent = `‚ùå Incorrect. That gives '${result}'`;
        }
      } catch (e) {
        document.getElementById("result").textContent = "‚ö†Ô∏è Error in your expression";
      }
    }

    newChallenge();
  </script>
</body>
</html>
